(self["webpackChunkrendez_vous_ci"]=self["webpackChunkrendez_vous_ci"]||[]).push([[609],{6609:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>_e});var l=t(3673),a=t(8880),i=t(2323);const o=(0,l.HX)("data-v-08454b64");(0,l.dD)("data-v-08454b64");const d={class:"col-md-7 col-lg-8 col-xl-9"},u={class:"row"},n={class:"col-sm-12"},r={class:"card"},c={class:"card-body"},m=(0,l.Wm)("h4",{class:"card-title"},"Définir votre calendrier",-1),h={class:"profile-box"},p={class:"row"},b={class:"col-lg-4"},v={class:"form-group"},g=(0,l.Wm)("label",null,"Durée des slots de temps",-1),W=(0,l.uE)('<option value="15" data-v-08454b64>15 mins</option><option value="30" data-v-08454b64>30 mins</option><option value="45" data-v-08454b64>45 mins</option><option value="60" data-v-08454b64>1 Heure</option><option value="120" data-v-08454b64>2 Heures</option>',5),f={class:"row"},y={class:"col-md-12"},_={class:"card schedule-widget mb-0"},k={class:"schedule-header"},w={class:"schedule-nav"},D={class:"card-title d-flex justify-content-between"},V=(0,l.Wm)("span",null,[(0,l.Uk)("Slots de temps "),(0,l.Wm)("p",{class:"text-subtitle1"},"Les slots de temps correspondent à vos horaires de disponibilités")],-1),j=(0,l.Wm)("i",{class:"fa fa-plus-circle"},null,-1),Z=(0,l.Uk)(" Ajouter un slot de temps"),P={key:0,class:"text-muted mb-0"},C={key:1,class:"doc-times"},U={class:"doc-slot-list"},q=(0,l.Wm)("i",{class:"fa fa-times"},null,-1),H={class:"modal-dialog ",style:{width:"500px"}},S={class:"modal-content"},Q={class:"modal-header"},T=(0,l.Wm)("span",{"aria-hidden":"true"},"×",-1),x={class:"modal-body"},M={class:"container"},z={key:0,class:"alert alert-danger alert-dismissible fade show",role:"alert"},A=(0,l.Wm)("strong",null,"Oups !",-1),O=(0,l.Uk)(" Il semble que vos heures se chevauchent. "),$=(0,l.Wm)("button",{type:"button",class:"close","data-dismiss":"alert","aria-label":"Close"},[(0,l.Wm)("span",{"aria-hidden":"true"},"×")],-1),I={class:"col-5"},K=(0,l.Wm)("label",null,"Début",-1),Y={class:"row items-center justify-end"},F={class:"col-5"},B=(0,l.Wm)("label",null,"Fin",-1),E={class:"row items-center justify-end"},L={key:0,class:"col-2"},X=(0,l.Wm)("label",{class:"d-md-block d-sm-none d-none"}," ",-1),G=(0,l.Wm)("i",{class:"far fa-trash-alt"},null,-1),J={class:"add-more mb-3"},N=(0,l.Wm)("i",{class:"fa fa-plus-circle"},null,-1),R=(0,l.Uk)(" Ajouter plus"),ee={class:"submit-section text-center"};(0,l.Cn)();const se=o(((e,s,t,se,te,le)=>{const ae=(0,l.up)("q-tab"),ie=(0,l.up)("q-tabs"),oe=(0,l.up)("q-tab-panel"),de=(0,l.up)("q-tab-panels"),ue=(0,l.up)("q-btn"),ne=(0,l.up)("q-time"),re=(0,l.up)("q-popup-proxy"),ce=(0,l.up)("q-icon"),me=(0,l.up)("q-input"),he=(0,l.up)("q-dialog"),pe=(0,l.Q2)("close-popup");return(0,l.wg)(),(0,l.j4)("div",d,[(0,l.Wm)("div",u,[(0,l.Wm)("div",n,[(0,l.Wm)("div",r,[(0,l.Wm)("div",c,[m,(0,l.Wm)("div",h,[(0,l.Wm)("div",p,[(0,l.Wm)("div",b,[(0,l.Wm)("div",v,[g,(0,l.wy)((0,l.Wm)("select",{"onUpdate:modelValue":s[1]||(s[1]=e=>te.duration=e),class:"select form-control"},[W],512),[[a.bM,te.duration]])])])]),(0,l.Wm)("div",f,[(0,l.Wm)("div",y,[(0,l.Wm)("div",_,[(0,l.Wm)("div",k,[(0,l.Wm)("div",w,[(0,l.Wm)(ie,{class:"nav nav-tabs nav-justified ",modelValue:te.tab,"onUpdate:modelValue":s[2]||(s[2]=e=>te.tab=e),dense:"","active-color":"white","active-bg-color":"pink-12","indicator-color":"pink-12",align:"justify","narrow-indicator":""},{default:o((()=>[((0,l.wg)(!0),(0,l.j4)(l.HY,null,(0,l.Ko)(te.days,((e,s)=>((0,l.wg)(),(0,l.j4)(ae,{key:s,name:e.id,class:"nav-item"},{default:o((()=>[(0,l.Wm)("span",null,(0,i.zw)(e.nom),1)])),_:2},1032,["name"])))),128))])),_:1},8,["modelValue"])])]),(0,l.Wm)(de,{modelValue:te.tab,"onUpdate:modelValue":s[3]||(s[3]=e=>te.tab=e),class:"tab-content schedule-cont"},{default:o((()=>[((0,l.wg)(!0),(0,l.j4)(l.HY,null,(0,l.Ko)(te.days,((e,s)=>((0,l.wg)(),(0,l.j4)(oe,{key:s,name:e.id},{default:o((()=>[(0,l.Wm)("h4",D,[V,(0,l.Wm)("a",{class:"edit-link",onClick:(0,a.iM)((e=>le.addDialog(s)),["prevent"]),href:"#"},[j,Z],8,["onClick"])]),0==e.slots.length?((0,l.wg)(),(0,l.j4)("p",P,"Pas disponible le "+(0,i.zw)(e.nom),1)):((0,l.wg)(),(0,l.j4)("div",C,[((0,l.wg)(!0),(0,l.j4)(l.HY,null,(0,l.Ko)(e.slots,((e,t)=>((0,l.wg)(),(0,l.j4)("div",{key:e.id,class:"doc-times"},[(0,l.Wm)("div",U,[(0,l.Uk)((0,i.zw)(e.heure_debut.substring(0,5)+" - "+e.heure_fin.substring(0,5))+" ",1),(0,l.Wm)("a",{href:"javascript:void(0)",onClick:e=>le.removeAddedSlot(s,t),class:"delete_schedule"},[q],8,["onClick"])])])))),128))]))])),_:2},1032,["name"])))),128))])),_:1},8,["modelValue"])])])])])])])])]),(0,l.Wm)(he,{modelValue:te.add_dialog,"onUpdate:modelValue":s[7]||(s[7]=e=>te.add_dialog=e),class:" ",onBeforeHide:s[8]||(s[8]=e=>le.hideDialog())},{default:o((()=>[(0,l.Wm)("div",H,[(0,l.Wm)("div",S,[(0,l.Wm)("div",Q,[(0,l.Wm)("h5",{class:"modal-title",disabled:te.overlapse},"Ajouter slot de temps",8,["disabled"]),(0,l.Wm)("button",{onClick:s[4]||(s[4]=e=>te.add_dialog=!1),type:"button",class:"close","data-dismiss":"modal","aria-label":"Close"},[T])]),(0,l.Wm)("div",x,[(0,l.Wm)("form",null,[(0,l.Wm)("div",M,[te.overlapse?((0,l.wg)(),(0,l.j4)("div",z,[A,O,$])):(0,l.kq)("",!0),((0,l.wg)(!0),(0,l.j4)(l.HY,null,(0,l.Ko)(te.slots,((e,s)=>((0,l.wg)(),(0,l.j4)("div",{key:s,class:"row"},[(0,l.Wm)("div",I,[K,(0,l.Wm)(me,{outlined:"",modelValue:e.heure_debut,"onUpdate:modelValue":s=>e.heure_debut=s,mask:"time",rules:["time"]},{append:o((()=>[(0,l.Wm)(ce,{name:"access_time",class:"cursor-pointer"},{default:o((()=>[(0,l.Wm)(re,{"transition-show":"scale","transition-hide":"scale"},{default:o((()=>[(0,l.Wm)(ne,{modelValue:e.heure_debut,"onUpdate:modelValue":s=>e.heure_debut=s},{default:o((()=>[(0,l.Wm)("div",Y,[(0,l.wy)((0,l.Wm)(ue,{label:"Close",color:"primary",flat:""},null,512),[[pe]])])])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:2},1024)])),_:2},1024)])),_:2},1032,["modelValue","onUpdate:modelValue"])]),(0,l.Wm)("div",F,[B,(0,l.Wm)(me,{outlined:"",modelValue:e.heure_fin,"onUpdate:modelValue":s=>e.heure_fin=s,mask:"time",rules:["time"]},{append:o((()=>[(0,l.Wm)(ce,{name:"access_time",class:"cursor-pointer"},{default:o((()=>[(0,l.Wm)(re,{"transition-show":"scale","transition-hide":"scale"},{default:o((()=>[(0,l.Wm)(ne,{modelValue:e.heure_fin,"onUpdate:modelValue":s=>e.heure_fin=s},{default:o((()=>[(0,l.Wm)("div",E,[(0,l.wy)((0,l.Wm)(ue,{label:"Close",color:"primary",flat:""},null,512),[[pe]])])])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:2},1024)])),_:2},1024)])),_:2},1032,["modelValue","onUpdate:modelValue"])]),0!=s?((0,l.wg)(),(0,l.j4)("div",L,[X,(0,l.Wm)("a",{href:"#",onClick:(0,a.iM)((e=>le.removeSlot(s)),["prevent"]),class:"btn btn-danger trash"},[G],8,["onClick"])])):(0,l.kq)("",!0)])))),128))]),(0,l.Wm)("div",J,[(0,l.Wm)("a",{href:"javascript:void(0);",onClick:s[5]||(s[5]=(0,a.iM)((e=>le.addSlot()),["prevent"])),class:"add-hours"},[N,R])]),(0,l.Wm)("div",ee,[(0,l.Wm)("button",{type:"submit",disabled:te.overlapse,onClick:s[6]||(s[6]=e=>le.sauvegarder()),class:"btn btn-primary submit-btn"},"Sauvegarder",8,["disabled"])])])])])])])),_:1},8,["modelValue"])])}));var te=t(515),le=t.n(te),ae=(t(7280),t(1959)),ie=t(7874),oe=t(5616);const de={data(){return{tab:null,add_dialog:(0,ae.iH)(!1),edit_dialog:!1,alert:!1,days:[],slots:[],duration:30,overlapse:!1,selectedDay:null}},mounted(){this.getDays(!0)},computed:le()({},(0,ie.Se)("auth",["authenticated","user"])),methods:{getDays(e=!1){this.$api.get("days",{params:{professionnal_id:this.user.userable.id,with:"slots"}}).then((s=>{this.days=s.data,1==e&&(this.tab=s.data[0].id)})).catch((e=>{console.log(e)}))},heureFin(e){let s=oe.ZP.buildDate({hours:e.heure_debut.split(":")[0],minutes:e.heure_debut.split(":")[1]});s=oe.ZP.addToDate(s,{minutes:this.duration});let t=s.getMinutes(),l=s.getHours();return t<10&&(t="0"+t),l<10&&(l="0"+l),l+":"+t},addSlot(){let e="07:00",s="07:00",t="07:00",l="";if(0!=this.days[this.selectedDay].slots.length&&(e=this.days[this.selectedDay].slots[this.days[this.selectedDay].slots.length-1].heure_fin),0!=this.slots.length&&(s=this.slots[this.slots.length-1].heure_fin),e=oe.ZP.buildDate({hours:e.slice(0,2),minutes:e.slice(3,5)}),s=oe.ZP.buildDate({hours:s.slice(0,2),minutes:s.slice(3,5)}),e>s){let s=e.getHours(),a=e.getMinutes();a<10&&(a="0"+a),s<10&&(s="0"+s),t=s+":"+a,l=oe.ZP.addToDate(e,{minutes:this.duration})}else{let e=s.getHours(),a=s.getMinutes();a<10&&(a="0"+a),e<10&&(e="0"+e),t=e+":"+a,l=oe.ZP.addToDate(s,{minutes:this.duration})}let a=l.getHours(),i=l.getMinutes();a<10&&(a="0"+a),i<10&&(i="0"+i),l=a+":"+i,this.overlapse||this.slots.push({heure_debut:t,heure_fin:l}),this.checkOverlapse()},hideDialog(){this.slots=[]},addDialog(e){this.add_dialog=!0,this.selectedDay=e,this.addSlot()},removeSlot(e){this.slots.splice(e,1),this.checkOverlapse()},removeAddedSlot(e,s){let t=this.days[e].slots[s].id;this.$api.delete("slots/"+t).then((t=>{console.log(t),this.days[e].slots.splice(s,1),this.$q.notify({message:"Slot de temps supprimé avec succès",color:"primary"})})).catch((e=>console.log(e)))},checkOverlapse(){let e=!1;if(0!=this.slots.length){let t,l,a=this.slots.slice(-1)[0],i=oe.ZP.buildDate({hours:a.heure_debut.split(":")[0],minutes:a.heure_debut.split(":")[1]}),o=oe.ZP.addToDate(i,{minutes:this.duration});for(var s=0;s<this.slots.length-1;s++)if(t=oe.ZP.buildDate({hours:this.slots[s].heure_debut.split(":")[0],minutes:this.slots[s].heure_debut.split(":")[1]}),l=oe.ZP.addToDate(t,{minutes:this.duration}),i<l&&o>t){e=!0;break}for(s=0;s<this.days[this.selectedDay].slots.length-1;s++)if(t=oe.ZP.buildDate({hours:this.days[this.selectedDay].slots[s].heure_debut.split(":")[0],minutes:this.days[this.selectedDay].slots[s].heure_debut.split(":")[1]}),l=oe.ZP.addToDate(t,{minutes:this.duration}),i<l&&o>t){e=!0;break}}this.overlapse=e},sauvegarder(){if(this.checkOverlapse(),!this.overlapse){let e=[],s=null;this.slots.forEach((t=>{s=this.heureFin(t),e.push({day_id:this.tab,heure_debut:t.heure_debut,heure_fin:s})})),this.$api.post("slots",e).then((e=>{this.$q.notify({message:"Slot de temps ajouté avec succès",color:"primary"}),this.getDays()})).catch((e=>console.log(e)))}}}};var ue=t(7547),ne=t(3269),re=t(5906),ce=t(6602),me=t(5926),he=t(4689),pe=t(4554),be=t(3944),ve=t(5990),ge=t(2165),We=t(677),fe=t(7518),ye=t.n(fe);de.render=se,de.__scopeId="data-v-08454b64";const _e=de;ye()(de,"components",{QTabs:ue.Z,QTab:ne.Z,QTabPanels:re.Z,QTabPanel:ce.Z,QDialog:me.Z,QInput:he.Z,QIcon:pe.Z,QPopupProxy:be.Z,QTime:ve.Z,QBtn:ge.Z}),ye()(de,"directives",{ClosePopup:We.Z})}}]);